<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swadesh Word Image Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-style: italic;
        }

        .button-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        button {
            background-color: #2c3e50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #34495e;
        }

        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }

        .words-display {
            background-color: #ecf0f1;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .words-display.empty {
            color: #7f8c8d;
            font-style: italic;
        }

        .word-list {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 10px;
        }

        .word-item {
            background-color: #3498db;
            color: white;
            padding: 12px 20px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
        }

        .loading-container {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading-container.active {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #2c3e50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-message {
            color: #2c3e50;
            font-size: 16px;
            font-weight: bold;
        }

        .patience-message {
            color: #7f8c8d;
            font-size: 14px;
            margin-top: 10px;
        }

        .image-container {
            display: none;
            text-align: center;
        }

        .image-container.active {
            display: block;
        }

        .image-container img {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .image-prompt {
            margin-top: 15px;
            padding: 15px;
            background-color: #ecf0f1;
            border-radius: 4px;
            color: #2c3e50;
            font-style: italic;
        }

        .error-message {
            display: none;
            background-color: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            text-align: center;
        }

        .error-message.active {
            display: block;
        }

        .info-box {
            background-color: #d6eaf8;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 14px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Swadesh Word Image Generator</h1>
        <p class="subtitle">Generate creative AI images from random word combinations</p>

        <div class="info-box">
            Click "Shuffle Words" to randomly select three words from different categories.
            If you like the combination, click "Generate Image" to create an AI-generated image
            based on those words using OpenAI's DALL-E.
        </div>

        <div class="button-container">
            <button id="shuffleBtn" onclick="shuffleWords()">Shuffle Words</button>
            <button id="generateBtn" onclick="generateImage()" disabled>Generate Image</button>
        </div>

        <div id="wordsDisplay" class="words-display empty">
            Click "Shuffle Words" to get started
        </div>

        <div id="loadingContainer" class="loading-container">
            <div class="spinner"></div>
            <div class="loading-message">Generating your image...</div>
            <div class="patience-message">Please be patient, this may take 15-30 seconds</div>
        </div>

        <div id="imageContainer" class="image-container">
            <img id="generatedImage" src="" alt="Generated Image">
            <div id="imagePrompt" class="image-prompt"></div>
        </div>

        <div id="errorMessage" class="error-message"></div>
    </div>

<script>
    // Three word lists for Swadesh-style combinations
    const wordLists = {
        list1: [
            'I', 'you', 'they', 'we',
            'this', 'that', 'here', 'there', 'who', 'what', 'where', 'when', 'how', 'not',
            'all', 'many', 'some', 'few', 'other', 'one', 'two', 'three', 'four', 'five',
            'big', 'long', 'wide', 'thick', 'heavy', 'small', 'short', 'narrow', 'thin',
            'woman', 'man', 'human being', 'child', 'wife', 'husband',
            'mother', 'father', 'animal', 'fish', 'bird', 'dog', 'louse', 'snake', 'worm',
            'tree', 'forest', 'stick', 'fruit', 'seed', 'leaf', 'root', 'tree bark',
            'flower', 'grass', 'rope', 'skin', 'meat', 'blood', 'bone', 'fat', 'egg',
            'horn', 'tail', 'feather', 'hair', 'head', 'ear', 'eye', 'nose', 'mouth', 'tooth',
            'tongue', 'fingernail', 'foot', 'leg', 'knee', 'hand', 'wing', 'belly',
            'guts', 'neck', 'back', 'breast', 'heart', 'liver', 'drink', 'eat', 'bite', 'suck',
            'spit', 'vomit', 'blow', 'breathe', 'laugh', 'see', 'hear', 'know', 'think',
            'smell', 'fear', 'sleep', 'live', 'die', 'kill', 'fight', 'hunt', 'hit', 'cut',
            'split', 'stab', 'scratch', 'dig', 'swim', 'fly', 'walk', 'come', 'lie',
            'sit', 'stand', 'turn', 'fall', 'give', 'hold', 'squeeze', 'rub',
            'wash', 'wipe', 'pull', 'push', 'throw', 'tie', 'sew', 'count', 'say', 'sing',
            'play', 'float', 'flow', 'freeze', 'swell', 'sun', 'moon', 'star', 'water', 'rain',
            'river', 'lake', 'sea', 'salt', 'stone', 'sand', 'dust', 'earth', 'cloud', 'fog',
            'sky', 'wind', 'snow', 'ice', 'smoke', 'fire', 'ash', 'burn', 'road', 'mountain',
            'red', 'green', 'yellow', 'white', 'black', 'night', 'day', 'year', 'warm', 'cold',
            'full', 'new', 'old', 'good', 'bad', 'rotten', 'dirty', 'straight', 'round',
            'sharp', 'dull', 'smooth', 'wet', 'dry', 'correct',
            'near', 'far', 'right', 'left', 'at', 'in', 'with', 'and', 'if', 'because', 'name'
        ],
        list2: [
            'I', 'you', 'they', 'we',
            'this', 'that', 'here', 'there', 'who', 'what', 'where', 'when', 'how', 'not',
            'all', 'many', 'some', 'few', 'other', 'one', 'two', 'three', 'four', 'five',
            'big', 'long', 'wide', 'thick', 'heavy', 'small', 'short', 'narrow', 'thin',
            'woman', 'man', 'human being', 'child', 'wife', 'husband',
            'mother', 'father', 'animal', 'fish', 'bird', 'dog', 'louse', 'snake', 'worm',
            'tree', 'forest', 'stick', 'fruit', 'seed', 'leaf', 'root', 'tree bark',
            'flower', 'grass', 'rope', 'skin', 'meat', 'blood', 'bone', 'fat', 'egg',
            'horn', 'tail', 'feather', 'hair', 'head', 'ear', 'eye', 'nose', 'mouth', 'tooth',
            'tongue', 'fingernail', 'foot', 'leg', 'knee', 'hand', 'wing', 'belly',
            'guts', 'neck', 'back', 'breast', 'heart', 'liver', 'drink', 'eat', 'bite', 'suck',
            'spit', 'vomit', 'blow', 'breathe', 'laugh', 'see', 'hear', 'know', 'think',
            'smell', 'fear', 'sleep', 'live', 'die', 'kill', 'fight', 'hunt', 'hit', 'cut',
            'split', 'stab', 'scratch', 'dig', 'swim', 'fly', 'walk', 'come', 'lie',
            'sit', 'stand', 'turn', 'fall', 'give', 'hold', 'squeeze', 'rub',
            'wash', 'wipe', 'pull', 'push', 'throw', 'tie', 'sew', 'count', 'say', 'sing',
            'play', 'float', 'flow', 'freeze', 'swell', 'sun', 'moon', 'star', 'water', 'rain',
            'river', 'lake', 'sea', 'salt', 'stone', 'sand', 'dust', 'earth', 'cloud', 'fog',
            'sky', 'wind', 'snow', 'ice', 'smoke', 'fire', 'ash', 'burn', 'road', 'mountain',
            'red', 'green', 'yellow', 'white', 'black', 'night', 'day', 'year', 'warm', 'cold',
            'full', 'new', 'old', 'good', 'bad', 'rotten', 'dirty', 'straight', 'round',
            'sharp', 'dull', 'smooth', 'wet', 'dry', 'correct',
            'near', 'far', 'right', 'left', 'at', 'in', 'with', 'and', 'if', 'because', 'name'
        ],
        list3: [
            'I', 'you', 'they', 'we',
            'this', 'that', 'here', 'there', 'who', 'what', 'where', 'when', 'how', 'not',
            'all', 'many', 'some', 'few', 'other', 'one', 'two', 'three', 'four', 'five',
            'big', 'long', 'wide', 'thick', 'heavy', 'small', 'short', 'narrow', 'thin',
            'woman', 'man', 'human being', 'child', 'wife', 'husband',
            'mother', 'father', 'animal', 'fish', 'bird', 'dog', 'louse', 'snake', 'worm',
            'tree', 'forest', 'stick', 'fruit', 'seed', 'leaf', 'root', 'tree bark',
            'flower', 'grass', 'rope', 'skin', 'meat', 'blood', 'bone', 'fat', 'egg',
            'horn', 'tail', 'feather', 'hair', 'head', 'ear', 'eye', 'nose', 'mouth', 'tooth',
            'tongue', 'fingernail', 'foot', 'leg', 'knee', 'hand', 'wing', 'belly',
            'guts', 'neck', 'back', 'breast', 'heart', 'liver', 'drink', 'eat', 'bite', 'suck',
            'spit', 'vomit', 'blow', 'breathe', 'laugh', 'see', 'hear', 'know', 'think',
            'smell', 'fear', 'sleep', 'live', 'die', 'kill', 'fight', 'hunt', 'hit', 'cut',
            'split', 'stab', 'scratch', 'dig', 'swim', 'fly', 'walk', 'come', 'lie',
            'sit', 'stand', 'turn', 'fall', 'give', 'hold', 'squeeze', 'rub',
            'wash', 'wipe', 'pull', 'push', 'throw', 'tie', 'sew', 'count', 'say', 'sing',
            'play', 'float', 'flow', 'freeze', 'swell', 'sun', 'moon', 'star', 'water', 'rain',
            'river', 'lake', 'sea', 'salt', 'stone', 'sand', 'dust', 'earth', 'cloud', 'fog',
            'sky', 'wind', 'snow', 'ice', 'smoke', 'fire', 'ash', 'burn', 'road', 'mountain',
            'red', 'green', 'yellow', 'white', 'black', 'night', 'day', 'year', 'warm', 'cold',
            'full', 'new', 'old', 'good', 'bad', 'rotten', 'dirty', 'straight', 'round',
            'sharp', 'dull', 'smooth', 'wet', 'dry', 'correct',
            'near', 'far', 'right', 'left', 'at', 'in', 'with', 'and', 'if', 'because', 'name'
        ]
    };
        let currentWords = [];
        let currentSeed = 0;

        // Seeded random number generator
        function seededRandom(seed) {
            const x = Math.sin(seed++) * 10000;
            return x - Math.floor(x);
        }

        function shuffleWords() {
            // Generate new random seed
            currentSeed = Math.floor(Math.random() * 1000000);

            // Select unique words from each list
            const selectedWords = [];
            let seedOffset = 0;

            // Select from list1
            let word1 = wordLists.list1[Math.floor(seededRandom(currentSeed + seedOffset) * wordLists.list1.length)];
            selectedWords.push(word1);
            seedOffset++;

            // Select from list2, ensure it's different from word1
            let word2;
            let attempts = 0;
            do {
                word2 = wordLists.list2[Math.floor(seededRandom(currentSeed + seedOffset) * wordLists.list2.length)];
                seedOffset++;
                attempts++;
            } while (selectedWords.includes(word2) && attempts < 100);
            selectedWords.push(word2);

            // Select from list3, ensure it's different from word1 and word2
            let word3;
            attempts = 0;
            do {
                word3 = wordLists.list3[Math.floor(seededRandom(currentSeed + seedOffset) * wordLists.list3.length)];
                seedOffset++;
                attempts++;
            } while (selectedWords.includes(word3) && attempts < 100);
            selectedWords.push(word3);

            currentWords = [word1, word2, word3];

            // Display the words
            const wordsDisplay = document.getElementById('wordsDisplay');
            wordsDisplay.classList.remove('empty');
            wordsDisplay.innerHTML = `
                <div>Your random words:</div>
                <div class="word-list">
                    <div class="word-item">${word1}</div>
                    <div class="word-item">${word2}</div>
                    <div class="word-item">${word3}</div>
                </div>
            `;

            // Enable generate button
            document.getElementById('generateBtn').disabled = false;

            // Hide previous image and error
            document.getElementById('imageContainer').classList.remove('active');
            document.getElementById('errorMessage').classList.remove('active');
        }

        async function generateImage() {
            if (currentWords.length === 0) {
                showError('Please shuffle words first!');
                return;
            }

            // Create prompt from words
            const prompt = `A creative and artistic interpretation of: ${currentWords.join(', ')}`;

            // Disable buttons
            document.getElementById('shuffleBtn').disabled = true;
            document.getElementById('generateBtn').disabled = true;

            // Show loading spinner
            document.getElementById('loadingContainer').classList.add('active');
            document.getElementById('imageContainer').classList.remove('active');
            document.getElementById('errorMessage').classList.remove('active');

            try {
                // Call Vercel API endpoint
                const response = await fetch('/api/generate-image', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        words: currentWords
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to generate image');
                }

                const data = await response.json();

                // Hide loading spinner
                document.getElementById('loadingContainer').classList.remove('active');

                // Display image
                document.getElementById('generatedImage').src = data.imageUrl;
                document.getElementById('imagePrompt').textContent = `Prompt: "${prompt}"`;
                document.getElementById('imageContainer').classList.add('active');

            } catch (error) {
                console.error('Error generating image:', error);
                document.getElementById('loadingContainer').classList.remove('active');
                showError(`Error: ${error.message}`);
            } finally {
                // Re-enable buttons
                document.getElementById('shuffleBtn').disabled = false;
                document.getElementById('generateBtn').disabled = false;
            }
        }

        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.textContent = message;
            errorElement.classList.add('active');
        }
    </script>
</body>
</html>
